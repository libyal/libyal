
build_script:
- ps: .\synclibs.ps1
- ps: .\autogen.ps1
- cmd: >-
    rem Prepare Visual Studio 2010 build

    C:\Python27\python.exe ..\libyal\scripts\msvscpp-convert.py --to 2010 msvscpp\${library_name}.sln

    rem Build with Visual Studio 2010

    msbuild vs2010\${library_name}.sln /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll"

    rem Prepare Visual Studio 2012 build

    C:\Python27\python.exe ..\libyal\scripts\msvscpp-convert.py --to 2012 msvscpp\${library_name}.sln

    rem Build with Visual Studio 2012

    msbuild vs2012\${library_name}.sln /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll"

    rem Prepare Visual Studio 2013 build

    C:\Python27\python.exe ..\libyal\scripts\msvscpp-convert.py --to 2013 msvscpp\${library_name}.sln

    rem Build with Visual Studio 2013

    msbuild vs2013\${library_name}.sln /logger:"C:\Program Files\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll"

    rem Prepare Cygwin build

    C:\cygwin\bin\bash -e -l -c "cd ${library_name}"

    C:\cygwin\bin\bash -e -l -c "./synclibs.sh && ./autogen.sh"

    rem Build with Cygwin

    C:\cygwin\bin\bash -e -l -c "./configure && make -j4"

    rem Prepare minGW build

    C:\msys64\usr\bin\bash -e -l -c "cd ${library_name}"

    C:\msys64\usr\bin\bash -e -l -c "./synclibs.sh && ./autogen.sh"

    rem Build with minGW 32-bit

    C:\msys64\usr\bin\bash -e -l -c "./configure --host=i686-w64-mingw32 && make -j4"

    rem Build with minGW 64-bit

    C:\msys64\usr\bin\bash -e -l -c "./configure --host=x86_64-w64-mingw32 && make -j4"

    rem Run tests

test_script:
- ps: .\runtests.ps1

